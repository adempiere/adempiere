<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Migrations>
  <Migration EntityType="D" Name="The fix t_rv_reconciliation to rv_reconciliation" ReleaseNo="3.8.0" SeqNo="2295">
    <Comments>https://github.com/adempiere/adempiere/issues/1038</Comments>
    <Step SeqNo="10" StepType="AD">
      <PO AD_Table_ID="100" Action="U" Record_ID="53285" Table="AD_Table">
        <Data AD_Column_ID="107" Column="TableName" oldValue="T_RV_Reconciliation">RV_Reconciliation</Data>
        <Data AD_Column_ID="6125" Column="IsView" oldValue="false">true</Data>
      </PO>
    </Step>
    <Step SeqNo="20" StepType="AD">
      <PO AD_Table_ID="115" Action="U" Record_ID="53398" Table="AD_Sequence">
        <Data AD_Column_ID="347" Column="Description" oldValue="Table T_RV_Reconciliation">Table RV_Reconciliation</Data>
        <Data AD_Column_ID="216" Column="Name" oldValue="T_RV_Reconciliation">RV_Reconciliation</Data>
      </PO>
    </Step>
    <Step DBType="Oracle" Parse="N" SeqNo="30" StepType="SQL">
      <SQLStatement>begin
execute immediate 'DROP VIEW T_RV_Reconciliation';
exception
when others then null;
end;</SQLStatement>
      <RollbackStatement>begin
execute immediate 'DROP VIEW RV_Reconciliation';
exception
when others then null;
end;</RollbackStatement>
    </Step>
    <Step DBType="Postgres" Parse="Y" SeqNo="30" StepType="SQL">
      <SQLStatement>DROP VIEW T_RV_Reconciliation;
CREATE OR REPLACE VIEW RV_Reconciliation AS
 SELECT f.ad_client_id,
    f.ad_org_id,
    f.isactive,
    f.created,
    f.createdby,
    f.updated,
    f.updatedby,
    f.fact_acct_id,
    f.c_acctschema_id,
    f.account_id,
    f.datetrx,
    f.dateacct,
    f.c_period_id,
    f.ad_table_id,
    f.record_id,
    f.line_id,
    f.gl_category_id,
    f.gl_budget_id,
    f.c_tax_id,
    f.m_locator_id,
    f.postingtype,
    f.c_currency_id,
    f.amtsourcedr,
    f.amtsourcecr,
    f.amtsource,
    f.amtacctdr,
    f.amtacctcr,
    f.amtacct,
    f.rate,
    f.c_uom_id,
    f.qty,
    f.m_product_id,
    f.c_bpartner_id,
    f.ad_orgtrx_id,
    f.c_locfrom_id,
    f.c_locto_id,
    f.c_salesregion_id,
    f.c_project_id,
    f.c_campaign_id,
    f.c_activity_id,
    f.user1_id,
    f.user2_id,
    f.user3_id,
    f.user4_id,
    f.a_asset_id,
    f.description,
    f.orgvalue,
    f.orgname,
    f.accountvalue,
    f.name,
    f.accounttype,
    f.bpartnervalue,
    f.bpname,
    f.c_bp_group_id,
    f.productvalue,
    f.productname,
    f.upc,
    f.m_product_category_id,
    t.ad_pinstance_id,
    t.matchcode
   FROM rv_fact_acct f
     JOIN t_reconciliation t ON f.fact_acct_id = t.fact_acct_id;</SQLStatement>
      <RollbackStatement>DROP VIEW RV_Reconciliation;
CREATE OR REPLACE VIEW t_rv_reconciliation AS
 SELECT f.ad_client_id,
    f.ad_org_id,
    f.isactive,
    f.created,
    f.createdby,
    f.updated,
    f.updatedby,
    f.fact_acct_id,
    f.c_acctschema_id,
    f.account_id,
    f.datetrx,
    f.dateacct,
    f.c_period_id,
    f.ad_table_id,
    f.record_id,
    f.line_id,
    f.gl_category_id,
    f.gl_budget_id,
    f.c_tax_id,
    f.m_locator_id,
    f.postingtype,
    f.c_currency_id,
    f.amtsourcedr,
    f.amtsourcecr,
    f.amtsource,
    f.amtacctdr,
    f.amtacctcr,
    f.amtacct,
    f.rate,
    f.c_uom_id,
    f.qty,
    f.m_product_id,
    f.c_bpartner_id,
    f.ad_orgtrx_id,
    f.c_locfrom_id,
    f.c_locto_id,
    f.c_salesregion_id,
    f.c_project_id,
    f.c_campaign_id,
    f.c_activity_id,
    f.user1_id,
    f.user2_id,
    f.user3_id,
    f.user4_id,
    f.a_asset_id,
    f.description,
    f.orgvalue,
    f.orgname,
    f.accountvalue,
    f.name,
    f.accounttype,
    f.bpartnervalue,
    f.bpname,
    f.c_bp_group_id,
    f.productvalue,
    f.productname,
    f.upc,
    f.m_product_category_id,
    t.ad_pinstance_id,
    t.matchcode
   FROM rv_fact_acct f
     JOIN t_reconciliation t ON f.fact_acct_id = t.fact_acct_id;</RollbackStatement>
    </Step>
    <Step DBType="Oracle" Parse="N" SeqNo="40" StepType="SQL">
      <SQLStatement>CREATE OR REPLACE VIEW RV_Reconciliation AS
 SELECT f.ad_client_id,
    f.ad_org_id,
    f.isactive,
    f.created,
    f.createdby,
    f.updated,
    f.updatedby,
    f.fact_acct_id,
    f.c_acctschema_id,
    f.account_id,
    f.datetrx,
    f.dateacct,
    f.c_period_id,
    f.ad_table_id,
    f.record_id,
    f.line_id,
    f.gl_category_id,
    f.gl_budget_id,
    f.c_tax_id,
    f.m_locator_id,
    f.postingtype,
    f.c_currency_id,
    f.amtsourcedr,
    f.amtsourcecr,
    f.amtsource,
    f.amtacctdr,
    f.amtacctcr,
    f.amtacct,
    f.rate,
    f.c_uom_id,
    f.qty,
    f.m_product_id,
    f.c_bpartner_id,
    f.ad_orgtrx_id,
    f.c_locfrom_id,
    f.c_locto_id,
    f.c_salesregion_id,
    f.c_project_id,
    f.c_campaign_id,
    f.c_activity_id,
    f.user1_id,
    f.user2_id,
    f.user3_id,
    f.user4_id,
    f.a_asset_id,
    f.description,
    f.orgvalue,
    f.orgname,
    f.accountvalue,
    f.name,
    f.accounttype,
    f.bpartnervalue,
    f.bpname,
    f.c_bp_group_id,
    f.productvalue,
    f.productname,
    f.upc,
    f.m_product_category_id,
    t.ad_pinstance_id,
    t.matchcode
   FROM rv_fact_acct f
     JOIN t_reconciliation t ON f.fact_acct_id = t.fact_acct_id</SQLStatement>
      <RollbackStatement>DROP VIEW RV_Reconciliation;
CREATE OR REPLACE VIEW t_rv_reconciliation AS
 SELECT f.ad_client_id,
    f.ad_org_id,
    f.isactive,
    f.created,
    f.createdby,
    f.updated,
    f.updatedby,
    f.fact_acct_id,
    f.c_acctschema_id,
    f.account_id,
    f.datetrx,
    f.dateacct,
    f.c_period_id,
    f.ad_table_id,
    f.record_id,
    f.line_id,
    f.gl_category_id,
    f.gl_budget_id,
    f.c_tax_id,
    f.m_locator_id,
    f.postingtype,
    f.c_currency_id,
    f.amtsourcedr,
    f.amtsourcecr,
    f.amtsource,
    f.amtacctdr,
    f.amtacctcr,
    f.amtacct,
    f.rate,
    f.c_uom_id,
    f.qty,
    f.m_product_id,
    f.c_bpartner_id,
    f.ad_orgtrx_id,
    f.c_locfrom_id,
    f.c_locto_id,
    f.c_salesregion_id,
    f.c_project_id,
    f.c_campaign_id,
    f.c_activity_id,
    f.user1_id,
    f.user2_id,
    f.user3_id,
    f.user4_id,
    f.a_asset_id,
    f.description,
    f.orgvalue,
    f.orgname,
    f.accountvalue,
    f.name,
    f.accounttype,
    f.bpartnervalue,
    f.bpname,
    f.c_bp_group_id,
    f.productvalue,
    f.productname,
    f.upc,
    f.m_product_category_id,
    t.ad_pinstance_id,
    t.matchcode
   FROM rv_fact_acct f
     JOIN t_reconciliation t ON f.fact_acct_id = t.fact_acct_id</RollbackStatement>
    </Step>
  </Migration>
</Migrations>
